# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –î–ë–û —á–µ—Ä–µ–∑ Mailu API

–ü—Ä–æ—Å—Ç–æ–π Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –î–ë–û: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–æ—á—Ç—ã —á–µ—Ä–µ–∑ Mailu REST API –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ VBA –º–∞–∫—Ä–æ—Å–æ–≤.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Mailu API

–ù–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ —Å Mailu –≤–∫–ª—é—á–∏—Ç–µ API –≤ `mailu.env`:

```bash
API=true
API_TOKEN=admin
```

–ó–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Mailu:
```bash
docker compose restart admin
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `dbo_operator_config_api.py` –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```python
EMAIL_ADDRESS = "operator1@financepro.ru"  # Email –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
EMAIL_PASSWORD = "1q2w#E$R"                # –ü–∞—Ä–æ–ª—å
API_URL = "http://10.18.2.6/api"           # URL Mailu API
API_TOKEN = "admin"                        # API —Ç–æ–∫–µ–Ω
CHECK_INTERVAL = 30                        # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫)
AUTO_OPEN_EXCEL = True                     # –ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ Excel
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install requests
```

### 4. –ó–∞–ø—É—Å–∫

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
python dbo_automation_api.py
```

–ò–ª–∏ –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ `dbo_automation_api.py` (–µ—Å–ª–∏ Python –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω —Å .py —Ñ–∞–π–ª–∞–º–∏)

### 5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Mailu —á–µ—Ä–µ–∑ REST API
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤—ã–µ –ø–∏—Å—å–º–∞ –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥
3. –°–∫–∞—á–∏–≤–∞–µ—Ç –≤—Å–µ –≤–ª–æ–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É **Downloads**
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Excel —Ñ–∞–π–ª—ã (.xlsm, .xlsx, .xls) –¥–ª—è –∑–∞–ø—É—Å–∫–∞ VBA –º–∞–∫—Ä–æ—Å–æ–≤

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è **–≤ –∫–æ–Ω—Å–æ–ª—å** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞
- –°–∫–∞—á–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –û—Ç–∫—Ä—ã—Ç—ã–µ Excel —Ñ–∞–π–ª—ã
- –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
dbo_operator_automation/
‚îú‚îÄ‚îÄ dbo_automation_api.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç (–∑–∞–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç!)
‚îú‚îÄ‚îÄ dbo_operator_automation_api.py # –ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API
‚îú‚îÄ‚îÄ dbo_operator_config_api.py    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ –ù–ê–°–¢–†–û–ô–ö–ê_API.md               # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ API
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ `dbo_operator_config_api.py`:

- `EMAIL_ADDRESS` - Email –∞–¥—Ä–µ—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- `EMAIL_PASSWORD` - –ü–∞—Ä–æ–ª—å –æ—Ç –ø–æ—á—Ç—ã
- `API_URL` - URL Mailu API (–Ω–∞–ø—Ä–∏–º–µ—Ä, http://10.18.2.6/api)
- `API_TOKEN` - API —Ç–æ–∫–µ–Ω –∏–∑ mailu.env
- `DOWNLOAD_DIR` - –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Downloads)
- `CHECK_INTERVAL` - –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `AUTO_OPEN_EXCEL` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å Excel —Ñ–∞–π–ª—ã

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API_URL
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API_TOKEN
- –í–∫–ª—é—á–µ–Ω –ª–∏ API –≤ mailu.env (API=true)
- –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä admin –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è mailu.env

### –§–∞–π–ª—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å:
- Excel —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ú–∞–∫—Ä–æ—Å—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ Excel
- –§–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –≤ Downloads

### Python –Ω–µ –Ω–∞–π–¥–µ–Ω

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.11 –∏–ª–∏ –≤—ã—à–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ python.org

## üìù –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
============================================================
–ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –û–ü–ï–†–ê–¢–û–†–ê –î–ë–û (—á–µ—Ä–µ–∑ Mailu API)
============================================================
Email: operator1@financepro.ru
API URL: http://10.18.2.6/api
–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–∫–∏: C:\Users\Operator\Downloads
–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 30 —Å–µ–∫
–ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ Excel: –î–∞
============================================================

‚úì –ü–∞–ø–∫–∞ Downloads –Ω–∞–π–¥–µ–Ω–∞: C:\Users\Operator\Downloads

============================================================
–ó–ê–ü–£–°–ö –ù–ï–ü–†–ï–†–´–í–ù–û–ô –ü–†–û–í–ï–†–ö–ò –ü–û–ß–¢–´
============================================================
–ü–û–ü–´–¢–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö MAILU API
API URL: http://10.18.2.6/api
‚úì API –¥–æ—Å—Ç—É–ø–µ–Ω
‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API —É—Å–ø–µ—à–Ω–æ
============================================================

============================================================
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—á—Ç—ã: 2024-12-14 14:00:00
============================================================
üì¨ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∏—Å–µ–º (–ª–∏–º–∏—Ç: 10)...
‚úì –ü–æ–ª—É—á–µ–Ω–æ –ø–∏—Å–µ–º: 1
üìß –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∏—Å—å–º–∞ ID: 12345
üìé –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π –∏–∑ –ø–∏—Å—å–º–∞ ID: 12345
‚úì –í–ª–æ–∂–µ–Ω–∏–µ #1 —Å–∫–∞—á–∞–Ω–æ: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
‚úì –°–∫–∞—á–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: 1
üìÇ –û—Ç–∫—Ä—ã—Ç–∏–µ Excel —Ñ–∞–π–ª–∞: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
‚úì Excel —Ñ–∞–π–ª –æ—Ç–∫—Ä—ã—Ç: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
```

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–°–º. —Ñ–∞–π–ª `–ù–ê–°–¢–†–û–ô–ö–ê_API.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Mailu API.
