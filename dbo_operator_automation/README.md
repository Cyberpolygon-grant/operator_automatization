# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –î–ë–û —á–µ—Ä–µ–∑ IMAP —Å SSH —Ç—É–Ω–Ω–µ–ª–µ–º

–ü—Ä–æ—Å—Ç–æ–π Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –î–ë–û: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–æ—á—Ç—ã —á–µ—Ä–µ–∑ IMAP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SSH —Ç—É–Ω–Ω–µ–ª—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ Excel —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ VBA –º–∞–∫—Ä–æ—Å–æ–≤.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SSH –¥–æ—Å—Ç—É–ø–µ–Ω –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ —Å Mailu:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
ssh user@10.18.2.6
```

–ï—Å–ª–∏ SSH —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏:

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
ssh-keygen -t rsa -b 4096

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—É—é –º–∞—à–∏–Ω—É
ssh-copy-id user@10.18.2.6
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `dbo_operator_config_ssh.py` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```python
EMAIL_ADDRESS = "operator1@financepro.ru"  # Email –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
EMAIL_PASSWORD = "1q2w#E$R"                # –ü–∞—Ä–æ–ª—å
SSH_HOST = "10.18.2.6"                     # IP —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã
SSH_USER = "iux"                           # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH (–∏–∑–º–µ–Ω–∏—Ç–µ!)
SSH_PORT = 22                              # SSH –ø–æ—Ä—Ç
CHECK_INTERVAL = 30                        # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫)
AUTO_OPEN_EXCEL = True                     # –ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ Excel
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Python, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è.

### 4. –ó–∞–ø—É—Å–∫

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
python dbo_automation_ssh.py
```

–ò–ª–∏ –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ `dbo_automation_api.py` (–µ—Å–ª–∏ Python –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω —Å .py —Ñ–∞–π–ª–∞–º–∏)

### 5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Mailu —á–µ—Ä–µ–∑ REST API
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤—ã–µ –ø–∏—Å—å–º–∞ –∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥
3. –°–∫–∞—á–∏–≤–∞–µ—Ç –≤—Å–µ –≤–ª–æ–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É **Downloads**
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Excel —Ñ–∞–π–ª—ã (.xlsm, .xlsx, .xls) –¥–ª—è –∑–∞–ø—É—Å–∫–∞ VBA –º–∞–∫—Ä–æ—Å–æ–≤

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è **–≤ –∫–æ–Ω—Å–æ–ª—å** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞
- –°–∫–∞—á–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –û—Ç–∫—Ä—ã—Ç—ã–µ Excel —Ñ–∞–π–ª—ã
- –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
dbo_operator_automation/
‚îú‚îÄ‚îÄ dbo_automation_ssh.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç (–∑–∞–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç!)
‚îú‚îÄ‚îÄ dbo_operator_automation_ssh.py # –ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å
‚îú‚îÄ‚îÄ dbo_operator_config_ssh.py     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ `dbo_operator_config_ssh.py`:

- `EMAIL_ADDRESS` - Email –∞–¥—Ä–µ—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- `EMAIL_PASSWORD` - –ü–∞—Ä–æ–ª—å –æ—Ç –ø–æ—á—Ç—ã
- `SSH_HOST` - IP –∞–¥—Ä–µ—Å —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã —Å Mailu
- `SSH_USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `SSH_PORT` - SSH –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
- `USE_SSL` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSL –¥–ª—è IMAP (False, —Ç–∞–∫ –∫–∞–∫ TLS –æ—Ç–∫–ª—é—á–µ–Ω)
- `DOWNLOAD_DIR` - –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Downloads)
- `CHECK_INTERVAL` - –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—á—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `AUTO_OPEN_EXCEL` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å Excel —Ñ–∞–π–ª—ã

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ SSH

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å SSH_HOST, SSH_USER, SSH_PORT
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å SSH (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ: `ssh user@host`)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏ SSH –∫–ª—é—á–∏ (–∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ)
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ OpenSSH –∫–ª–∏–µ–Ω—Ç

### –§–∞–π–ª—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å:
- Excel —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ú–∞–∫—Ä–æ—Å—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ Excel
- –§–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –≤ Downloads

### Python –Ω–µ –Ω–∞–π–¥–µ–Ω

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.11 –∏–ª–∏ –≤—ã—à–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ python.org

## üìù –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
============================================================
–ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –û–ü–ï–†–ê–¢–û–†–ê –î–ë–û (—á–µ—Ä–µ–∑ SSH —Ç—É–Ω–Ω–µ–ª—å)
============================================================
Email: operator1@financepro.ru
SSH: iux@10.18.2.6:22
IMAP —á–µ—Ä–µ–∑ —Ç—É–Ω–Ω–µ–ª—å: localhost:1430
–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–∫–∏: C:\Users\Operator\Downloads
–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 30 —Å–µ–∫
–ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ Excel: –î–∞
============================================================

‚úì –ü–∞–ø–∫–∞ Downloads –Ω–∞–π–¥–µ–Ω–∞: C:\Users\Operator\Downloads

============================================================
–ó–ê–ü–£–°–ö –ù–ï–ü–†–ï–†–´–í–ù–û–ô –ü–†–û–í–ï–†–ö–ò –ü–û–ß–¢–´
============================================================
–ü–û–ü–´–¢–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –ö –ü–û–ß–¢–ï –ß–ï–†–ï–ó SSH –¢–£–ù–ù–ï–õ–¨
üîó –°–æ–∑–¥–∞–Ω–∏–µ SSH —Ç—É–Ω–Ω–µ–ª—è...
   SSH: iux@10.18.2.6:22
   –¢—É–Ω–Ω–µ–ª—å: localhost:1430 -> localhost:143
‚úì SSH —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–Ω: localhost:1430
IMAP —á–µ—Ä–µ–∑ —Ç—É–Ω–Ω–µ–ª—å: localhost:1430
‚úì –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
‚úì –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
‚úì –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö –ü–û–ß–¢–ï –£–°–¢–ê–ù–û–í–õ–ï–ù–û
============================================================

============================================================
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—á—Ç—ã: 2024-12-14 14:00:00
============================================================
üì¨ –ù–∞–π–¥–µ–Ω–æ –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º: 1
üìß –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∏—Å—å–º–∞ ID: 1
   –û—Ç: client@bank.ru
   –¢–µ–º–∞: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
üìé –ü–æ–∏—Å–∫ –≤–ª–æ–∂–µ–Ω–∏–π –≤ –ø–∏—Å—å–º–µ ID: 1
   –ù–∞–π–¥–µ–Ω–æ –≤–ª–æ–∂–µ–Ω–∏–µ #1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
‚úì –í–ª–æ–∂–µ–Ω–∏–µ #1 —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω–æ
‚úì –í—Å–µ–≥–æ –≤–ª–æ–∂–µ–Ω–∏–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 1/1
‚úì –°–∫–∞—á–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: 1
üìÇ –û—Ç–∫—Ä—ã—Ç–∏–µ Excel —Ñ–∞–π–ª–∞: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
‚úì Excel —Ñ–∞–π–ª –æ—Ç–∫—Ä—ã—Ç: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_—Ñ–æ—Ä–º–∞.xlsm
```

## üîó –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–µ—Ç SSH —Ç—É–Ω–Ω–µ–ª—å: `localhost:1430` -> `—É–¥–∞–ª–µ–Ω–Ω–∞—è_–º–∞—à–∏–Ω–∞:143`
2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ IMAP —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç `1430`
3. SSH —Ç—É–Ω–Ω–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—É—é –º–∞—à–∏–Ω—É
4. –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Ä—Ç—ã 143/993 –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ SSH (–ø–æ—Ä—Ç 22)

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- SSH –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω —Å –≤–∞—à–µ–π –º–∞—à–∏–Ω—ã
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –∫–ª—é—á–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è, –µ—Å–ª–∏ SSH —Ç—É–Ω–Ω–µ–ª—å —Ä–∞–∑–æ—Ä–≤–µ—Ç—Å—è
